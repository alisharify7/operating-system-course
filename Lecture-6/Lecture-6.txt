سیستم عامل جلسه ششم
زمانبندی صف چند سطحی
دسته ی دیگیری از الگوریتم های زمانبندی برای وضعیت هایی ایجاد شدند که در آن ها، فرایند ها می توانند به دو گروه تقسیم شوند. به عنوان مثال، یک تقسیم بندی متدوال این است که فرایند ها دو دسته اند: فرایند های پیش زمینه (محاوره ای) و پس زمینه (دسته ای). این دو نوع فرایند، زمان پاسخ زمان پاسخ متفاوتی دارند و در نتیجه باید زمانبندی های متفاوتی داشته باشند. علاوه بر این ممکن است فرایند های پیش زمینه اولویت بیشتری نسبت به فرایند های پس زمینه داشته باشند

الگوریتم زمانبندی صف چند سطحی، صف آماده را به چند بخش مجزا تقسیم می کند. هر فرایند بر اساس صفاتی که دارد در صفی قرار می گیرد. این صفات عبارت اند از: اندازه حافظه، اولویت فرایند، نوع فرایند.

هر صف، الگوریتم زمانبندی خاص خودش را دارد. به عنوان مثال، ممکن است برای فرایند های پیش زمینه و پس زمینه از صف های جداگانه ای استفاده شود و صف پیش زمینه بر اساس الگوریتم RR و صف پس زمینه بر اساس الگوریتم FCFS زمانبندی شود.
علاوه بر این، بین صف ها نیز باز زمانبندی وجود داشته باشد که بر اساس زمانبندی همراه با قبضه کردن (Preemptive)  و با اولویت ثابت ، پیاده سازی می شود.
 به عنوان مثال: صف پیش زمینه ممکن است نسبت به صف پس زمینه اولویت مطلق(بیشتری) داشته باشد


هر صف نسبت به صف های با اولویت پایین تر، اولویت  مطلقی دارد.
امکان دیگر، استفاده از برهه ی زمانی در بین صف هاست. هر صف بخشی از از زمان پردازنده را به خود اختصاص می دهد و می تواند بین فرایند های مختلف خود زمانبندی کند. به عنوان نمونه در مثالِ مربوط به فرایند های پیش زمینه و پس زمینه، صف پیش زمینه می تواند 80 درصد پردازنده را در اختیار گیرد و آن را به روش RR بین فرایند هایش زمانبندی کند، در حالی که صف پس زمینه 20 دردصد وقت پردازنده را در اختیار می گیرد و آن را به روش FCFS بین فرایند هایش زمانبندی می کند.





زمانبندی صف چند سطحی بازخوردی (فیدبک)(feedback)

معمولا در الگوریتم زمانبندی صف چند سطحی، فرایند ها هنگام ورود به سیستم در صفی قرار می گیرند. به طوری که از صفی به صف دیگر نمی رود. به عنوان مثال» اگر صف های جداگانه ای برای فرایند های پیش زمینه و پس زمینه وجود داشته باشد، فرایند ها از صفی به صف دیگر منتقل نمی شوند، زیرا ماهیت پیش زمینه ای و پس زمینه ای آن ها تغییر نمی کند. این کار موجب کاهش سربار زمانبندی می شود ولی قابلیت انعطاف کم می شود
اما، الگوریتم زمانبندی صف چند سطحی بازخوردی به فرایند ها اجازه می دهد از صفی به صف دیگر منتقل شوند. فلسفه ی این کار این است که ویژگی های انفجار های پردازنده ی فرایند ها با یکدیگر متفاوت است. اگر فرایندی پردازنده را مدت زیادی در اختیار گیرد، به صفی با اولویت پایین تر منتقل می شود. بدین ترتیب، فرایند های در تنگنای i/o و محاوره ای، در صف هایی با اولویت بالاتر قرار می گیرند. به طور مشابه ، فرایندی که به مدت زیادی در صفی با اولویت پایین تر منتظر می ماند، ممکن است به صفی با اولویت بالاتر منتقل شود. در این شکل سالمندی (Aging) ، از مشکل گرسنگی (قحطی) (starving)  جلوگیری می شود به عنوان مثال، یک زمانبند صف چند سطحی بازخوردی ، با سه صف را در نظر بگیرید گه از صف تا 2 شماره گذاری شده اند.
زمانبند ابتدا تمام فرایند های موجود در صف را اجرا می کند. وقتی صف صفر خالی باشد، فرایند های صف 1 اجرا می شوند. به همین ترتیب، فرایند های صف 2 وقتی اجرا می شوند که صف های 0 و 1 خالی باشند. فرایندی که برای صف 1 می آید. یک فرایند از صف 2 را قبضه می کند. به همین ترتیب، هر فرایند موجود در صف 1 ، توسط فرایندی که جدیدا وارد صف صفر می شود ، قبضه (Preemptive) می شود
فرایندی که می خواهد به صف آماده وارد شود در صف صفر قرار می گیرد. به هر فرایند در صف صفر، کوانتوم زمانی 8 میلی ثانیه  ای نسبت داده می شود. اگر فرایندی در این مدت زمان به اتمام نرسد، به انتهای صف 1 منتقل می شود. اگر صف صفر خالی باشد، به فرایند موجود در ابتدای صف 1 ، کوانتوم زمانی 16 میلی ثانیه ای تخصیص می یابد. اگر اجرای ان در این مدت زمان کامل نشد، قبضه می شود و در صف 2 قرار داده می شود. در صورتی که هر یک از دو صف 0 و 1 خالی باشند؛ فرایند های موجود در صف 2 بر اساس الگوریتم FCFS اجرا می شوند.
این الگوریتم زمانبندی ، به فرایندی که انفجار پردازنده ی آن کمتر یا مساوی 8 میلی ثانیه ای باشد، بالاترین اولویت را می دهد. چنین فرایندی، سریعا پردازنده را در اختیار می گیرد، انفجار پردازنده ی خودش را انجامدهد و به انفجار بعدی i/o خود می رود فرایند هایی که به بیش از (16+8) کوانتوم زمانی نیاز داشته باشند، گرچه اولویت کمتری نسبت به فرایند های کوتاه تر دارند ، ولی سریعا اجرا می شوند. فرایند های طولانی با زمان بیشتر از 24 کوانتوم زمانی، به طور خودکار به صف 2 می روند و به ترتیب FCFS اجرا می شوند ( با چرخه های پردازنده ی باقی مانده از صف 0 و 1)
زمانبند صف چند سطحی بازخوردی با پارامتر های زیر تعریف می شوند
• تعداد صف ها
• الگوریتم زمانبندی برای هر صف
• روشی که تعیین می کند چه هنگامی یک فرایند به صفی با اولویت بیشتر منتقل شود.
• روشی که تعیین می کند چه هنگامی یک فرایند به صفی با اولویت کمتر منتقل شود.
• روشی که تعیین می کند فرایندی که نیاز به هدمات دارد، به چه صفی وارد شود.
زمانبند صف چند سطحی بازخوردی، متداول ترین الگوریتم زمانبندی پردازنده است.
این الگوریتم، پیچیده ترین الگوریتم است، زیرا تعریف بهترین زمان، نیاز به ابزار هایی برای انتخاب مقادیر برای تمام پارامتر ها دارد.

